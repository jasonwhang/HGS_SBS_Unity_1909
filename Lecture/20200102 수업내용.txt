2020.01.02 목요일 - 수업내용

// ----------------------------------------------------------------------------------------
1. Player의 레벨들을 저장하고 불러오는 기능을 추가

- PlayerInfoController.cs에서 Load함수를 만든다.
public void Load(int[] levelArr)
{
    // levelArr은 구버전이었을 때의 세이브데이터이다.
    // mInfos는 최신버전일 때의 세이브데이터이다.
    // 구버전의 세이브데이터를 우선 불러오고 새롭게 추가되는 데이터들은 추가작업으로 데이터를 넣어준다.
    for(int i = 0; i < levelArr.Length; i++)
    {
        mInfos[i].Level = levelArr[i];
        // 아래의 경우 mInfos[0]의 경우 레벨이 1부터 시작하기 때문에 계산방식이 맞지 않게 된다.
        //ApplyLevelUP(i, levelArr[i]); 

        // 로드가 된 데이터를 가지고 현재 데이터의 정보를 계산해준다.
        CalcAndShowData(i);
    }
}


- PlayerInfoController.cs에서 ApplyLevelUp함수에서 계산하는 내용을 새롭게 함수로 만들어 관리한다.
=> private void CalcAndShowData(int id)

// ----------------------------------------------------------------------------------------
2. Colleage의 레벨들을 저장하고 불러오는 기능을 추가

- ColleagueController.cs에서 Load함수를 만든다.

- ColleagueController.cs에서 ApplyLevel함수에서 계산하는 부분을 가져온다.
public void CalcAndShowData(int id)
{
    mDataArr[id].ValueCurrent = mDataArr[id].ValueBase * 
                                Math.Pow(mDataArr[id].ValueWeight, mDataArr[id].Level);
    mDataArr[id].CostCurrent = mDataArr[id].CostBase * 
                                Math.Pow(mDataArr[id].CostWeight, mDataArr[id].Level);
    mElementList[id].Renew(mDataArr[id].Contents, "구매", mDataArr[id].Level,
                           mDataArr[id].ValueCurrent, mDataArr[id].CostCurrent,
                           mDataArr[id].JobTime);
}

// ----------------------------------------------------------------------------------------
3. Colleage의 Element가 생성되는 시점이랑 데이터가 Loat되는 시점이랑 같아서 Null에러가 난다.

- Element가 생성되는 시점이랑 Load가 되는 시점이랑 Start함수에서 동시에 진행이 된다.
=> Element가 생성되는 시점을 Awake로 바꾸는 방법
=> Load가 되는 함수를 코루틴으로 만든다.

- ColleageController.cs와 PlayerInfoController.cs에서 bool변수를 만들어 대기를 시켜준다.
=> 로드가 다 되는 동안 대기를 시켜주도록 bool변수를 추가

- GameController.cs에서 LoadGames라는 코루틴 함수를 만들어준다.

- GameController.cs에서 Start함수에서 코루틴함수를 실행시켜준다.




























































































































































